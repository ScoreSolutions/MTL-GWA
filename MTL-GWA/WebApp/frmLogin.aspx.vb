Imports Engine.Auth
Imports Engine.Common
Imports Para.TABLE
Imports Para.Common
Imports Para.Common.Utilities
Imports System.Web.Security
Imports System.Xml.Serialization
Imports System.IO
Imports Para.CallWS
Imports Para.OutputWS


Partial Class WebApp_frmLogin
    Inherits System.Web.UI.Page
    Dim uPara As UsersPara

    Dim _err As String = ""
    Protected Sub btnLogin_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnLogin.Click
        If Valid() = True Then
            Dim _IsChagePwd As Boolean = False
            If uPara.ID <> 0 Then
                If uPara.USER_E_DATE.Value.Year <> 1 Then
                    If Today.Date > uPara.USER_E_DATE.Value.Date Then 'User หมดอายุ
                        _err = "ชื่อผู้ใช้ของท่านหมดอายุแล้ว ไม่สามารถเข้าสู่ระบบได้ \r\n( User ID has expire. Cannot logon to system. )"
                    End If
                End If
                'If uPara.LOGIN_FAIL_COUNT > Config.GetConfigValue(Constant.SystemConfig.LoginFailLimit) Then
                '    _err = "รหัสผ่านของท่านถูกระงับการใช้งาน กรุณาติดต่อเจ้าหน้าที่"
                'End If

                If _err = "" Then
                    If Today.Date > uPara.PASSWD_DATE.Date Then
                        'รหัสผ่านหมดอายุ บังคับให้เปลี่ยนรหัสผ่าน
                        _IsChagePwd = True
                        CreateUserProfile(uPara)
                        Session(Constant.ForceChangePasswordSession) = "Y"
                        'Response.Redirect("frmUsersChangePassword.aspx?rnd=" & DateTime.Now.Millisecond)

                        Dim popupScript = "<script language='javascript'> " & _
                                            " alert('รหัสผ่านหมดอายุ กรุณาเปลื่ยนรหัสผ่าน \r\n( Password has expired. Please change your password. )'); " & _
                                            " window.open('../WebApp/frmUsersChangePassword.aspx?rnd=" & DateTime.Now.Millisecond & "', '_self','');" & _
                                            " </script>"
                        ScriptManager.RegisterStartupScript(Me, GetType(String), "MTL-GWA", popupScript, False)
                    ElseIf uPara.IS_FIRST_LOGIN = "Y" Then
                        'Login ครั้งแรก บังคับให้เปลี่ยนรหัสผ่าน
                        _IsChagePwd = True
                        CreateUserProfile(uPara)
                        Session(Constant.ForceChangePasswordSession) = "Y"
                        'Response.Redirect("frmUsersChangePassword.aspx?rnd=" & DateTime.Now.Millisecond)

                        Dim popupScript = "<script language='javascript'> " & _
                                            " alert('ท่านเข้าสู่ระบบเป็นครั้งแรก กรุณาเปลี่ยนรหัสผ่าน \r\n( Login at first time. Please change your password. )'); " & _
                                            " window.open('../WebApp/frmUsersChangePassword.aspx?rnd=" & DateTime.Now.Millisecond & "', '_self','');" & _
                                            " </script>"
                        ScriptManager.RegisterStartupScript(Me, GetType(String), "MTL-GWA", popupScript, False)
                    ElseIf Today.AddDays(Config.GetConfigValue(Constant.SystemConfig.AlertPasswordExpireDate)) >= uPara.PASSWD_DATE Then
                        'ระบบเตือนล่วงหน้าก่อนรหัสผ่านหมดอายุ
                        _IsChagePwd = True
                        CreateUserProfile(uPara)

                        Dim difDate As Integer = DateDiff(DateInterval.Day, Today, uPara.PASSWD_DATE)
                        Dim popupScript = "<script language='javascript'> "

                        If difDate <= 0 Then
                            If DateDiff(DateInterval.Day, uPara.PASSWD_DATE, uPara.USER_E_DATE.Value) = 0 Then
                                popupScript += " alert('รหัสผู้ใช้ของท่านกำลังจะหมดอายุ กรุณาติดต่อเจ้าหน้าที่ \r\n( Your password will expire soon; Please contact our staff. )'); "
                            Else
                                popupScript += " alert('รหัสผ่านของท่านใกล้จะหมดอายุ กรุณาเปลี่ยนรหัสผ่านภายในวันนี้ \r\n( Your password will expire soon; Please change your password within today. )'); "
                            End If
                        Else
                            popupScript += " alert('รหัสผ่านของท่านใกล้หมดอายุในอีก " & difDate & " วัน กรุณาเปลี่ยนรหัสผ่าน \r\n( Your password to expire in the next " & DateDiff(DateInterval.Day, Today, uPara.PASSWD_DATE) & " days, please change your password. )'); "
                        End If

                        popupScript += " window.open('../WebApp/frmGroupPolicySearch.aspx?rnd=" & DateTime.Now.Millisecond & "', '_self','');"
                        popupScript += " </script>"
                        ScriptManager.RegisterStartupScript(Me, GetType(String), "MTL-GWA", popupScript, False)
                    End If
                End If
            Else
                _err = "ไม่พบข้อมูลผู้ใช้งาน"
            End If

            If uPara.USER_ID.ToUpper <> "SYSTEM" Then
                CreateUserJoinCasePara(uPara.USER_ID)  'ช้ามากๆ
            End If

            If _err.Trim = "" Then
                If _IsChagePwd = False Then
                    CreateUserProfile(uPara)
                    Response.Redirect("frmGroupPolicySearch.aspx?rnd=" & DateTime.Now.Millisecond)
                End If
            Else
                Config.SetAlert(_err, Me)
            End If
        End If
    End Sub

    Private Sub CreateUserProfile(ByVal para As UsersPara)
        Session.Remove(Constant.UserMenuSession)

        Dim uPara As New UserProfilePara
        'uPara.USER_PARA = para
        uPara.USER_ID = para.USER_ID

        Dim eng As New LogENG
        eng.SaveLoginHistory(para, Request)
        uPara.LOGIN_HISTORY_ID = eng.LOGIN_HISTORY_ID

        'Create LoginSession
        Dim sr As New XmlSerializer(GetType(UserProfilePara))
        Dim st As New MemoryStream()
        sr.Serialize(st, uPara)
        Dim b() As Byte = st.GetBuffer()
        Dim SerialUserData As String = Convert.ToBase64String(b)

        'con not use bellow code TonG
        HttpContext.Current.Response.Cookies.Clear()

        Dim fat As New FormsAuthenticationTicket(1, uPara.USER_ID, DateTime.Now, DateTime.Now.AddMinutes(10), False, SerialUserData)
        Dim ck As New System.Web.HttpCookie(".MTLGWA")
        ck.Value = FormsAuthentication.Encrypt(fat)
        ck.Expires = fat.Expiration
        HttpContext.Current.Response.Cookies.Add(ck)

        'Set Login Success
        Dim lEng As New LogInENG
        If lEng.SetLoginSuccess(para.USER_ID, para.ID) = False Then
            LogENG.SaveErrorLog(lEng.ErrorMessage, Config.GetLogOnUser)
        End If
    End Sub

    Private Sub CreateUserJoinCasePara(ByVal UserID As String)
        Try
            Dim eng As New WebServiceENG
            Dim inp As New InputGetUserJoinCasePara
            inp.USER_ID = UserID

            Dim oup As OutputGetUserJoinCasePara = eng.GetUserJoinCase(inp)
            If oup.ISFOUND_CASE = "Y" Then
                Session(Constant.UserJoinCaseSession) = oup
            ElseIf oup.ISFOUND_CASE = "N" Then
                Session(Constant.UserJoinCaseSession) = oup
                LogENG.SaveErrorLog("Cannot GetUserJoinCase : " & eng.ErrorMessage, Config.GetLogOnUser)
            ElseIf oup.ISFOUND_CASE = "" Then
                _err = eng.ErrorMessage
                LogENG.SaveErrorLog("Cannot GetUserJoinCase : " & eng.ErrorMessage, Config.GetLogOnUser)
                Config.SetAlert(eng.ErrorMessage, Me, txtUserName.ClientID)
            End If
        Catch ex As TimeoutException
            Config.SaveErrorLog(ex.Message)
            Config.SetAlert(ex.Message, Me)
        Catch ex As Exception
            Config.SaveErrorLog(ex.Message)
            Config.SetAlert(ex.Message, Me)
        End Try

    End Sub

    Private Function Valid() As Boolean
        Dim ret = True
        Dim eng As New LogInENG

        'Dim test As String = "0008|00140055|A80-0013|โรงเรียน อนุบาลพิมพ์รพี|04/18/2004|04/17/2005|7|GP112|T##G80-0008|00140072|A80-0016|โรงเรียน อนุบาลรักษ์ดรุณ|07/01/2001|06/30/2002|1|GP106|T##G80-0008|00140138|A08-0380|ศูนย์พัฒนาเด็กเล็กตำบลบึงยี่โถ|05/14/2011|05/13/2012|4|GP404|T##G80-0008|00140139|A08-0385|โรงเรียน อนุบาลวณลักษณ์|05/20/2011|05/19/2012|4|GP403|T##G80-0008|00140140|A08-0433|โรงเรียน ปัญญาดี|05/16/2010|05/15/2011|3|GP402|T##G80-0008|00140141|A08-0397|โรงเรียนอนุบาลประศาสน์วิทยา จันทบุรี|05/20/2008|05/19/2009|1|GP404|T##G80-0008|00140142|A08-0396|โรงเรียน พัฒนาเยาวชน|05/16/2008|05/15/2009|1|GP403|T##G80-0008|00140143|A08-0432|โรงเรียน ธำรงวัฒนา พัฒนาเยาวชน|05/16/2008|05/15/2009|1|GP402|T##G80-0008|00140144|A08-0416|โรงเรียนชุมชนวัดศรีมณีวรรณ (ธรรมศิริอุปถัมภ์)|05/23/2009|05/22/2010|2|GP404|T##G80-0008|00140145|A08-0491|โรงเรียน สหชาติเศรษฐกิจวิทยา|05/25/2009|05/24/2010|2|GP403|T##G80-0008|00140146|A08-0478|โรงเรียน อนุบาลบ้านไทย|05/20/2011|05/19/2012|4|GP402|T##G80-0008|00140147|A08-0469|โรงเรียนสวนเด็ก|05/27/2008|05/26/2009|1|GP404|T##G80-0008|00140148|A08-0492|โรงเรียน สันติวัน|05/26/2011|05/25/2012|4|GP403|T##G80-0008|00140149|A08-0479|ศูนย์พัฒนาเด็กเล็กชุมชนเสนานิคม|06/04/2008|06/03/2009|1|GP402|T##G80-0008|00140150|A08-0513|โรงเรียนอนุบาลปราณบุรี|06/05/2008|06/04/2009|1|GP404|T##G80-0008|00140151|A08-0521|โรงเรียน อนุบาลระพีพรรณ|06/06/2011|06/05/2012|4|GP403|T##G80-0008|00140152|A08-0515|โรงเรียน วัดใหญ่สว่างอารมณ์|06/06/2011|06/05/2012|4|GP402|T##G80-0008|00140153|A08-0514|โรงเรียนอนุบาลปรานี|06/04/2011|06/03/2012|4|GP404|T##G80-0008|00140154|A08-0522|ศูนย์พัฒนาเด็กก่อนวัยเรียนชุมชนแผ่นดินทองยายชุ่มอุทิศ|06/06/2011|06/05/2012|4|GP403|T##G80-0008|00140155|A08-0516|ศูนย์พัฒนาเด็กเล็กก่อนวัยเรียนหมู่บ้านวัชรปราณี|06/04/2011|06/03/2012|4|GP402|T##G80-0008|00140156|A08-0589|โรงเรียนสันป่ายางวิทยาคม|05/16/2008|05/15/2009|1|GP404|T##G80-0008|00140157|A08-0533|โรงเรียน วัดสว่าง|06/12/2009|06/11/2010|2|GP403|T##G80-0008|00140158|A08-0547|โรงเรียน อนุบาลเสริมปัญญาพุดตาน|06/27/2009|06/26/2010|2|GP402|T##G80-0008|00140159|A08-0591|โรงเรียนเสริมปัญญาอนุบาล|06/27/2009|06/26/2010|2|GP404|T##G80-0008|00140160|A08-0534|ศูนย์พัฒนาเด็กก่อนวัยเรียน ชุมชนธรากร|06/12/2011|06/11/2012|4|GP403|T##G80-0008|00140161|A08-0549|โรงเรียน บ้านคลองเสาเหนือ|06/12/2009|06/11/2010|2|GP402|T##G80-0008|00140162|A08-0592|โรงเรียนอนุบาลสุวัฒนา|06/18/2011|05/15/2012|4|GP404|T##G80-0008|00140163|A08-0588|ศูนย์พัฒนาเด็กก่อนวัยเรียน วัดบุญศรีมุนีกรณ์|06/24/2011|06/23/2012|4|GP403|T##G80-0008|00140164|A08-0635|ศูนย์พัฒนาเด็กเล็กองค์การบริหารส่วนตำบลดงมูลเหล็ก|06/30/2008|06/29/2009|1|GP402|T##G80-0008|00140165|A08-0590|โรงเรียนอนุบาลมีลำใย|06/26/2011|06/25/2012|4|GP404|T##G80-0008|00140166|A08-0704|โรงเรียนอรอนงค์|05/26/2011|05/25/2012|4|GP403|T##G80-0008|00140167|A08-0636|โรงเรียน อนุบาลเครือคล้าย|06/26/2008|06/25/2009|1|GP402|T##G80-0008|00140168|A08-0640|โรงเรียนบ้านหนองท่อม|06/25/2009|06/24/2010|2|GP404|T##G80-0008|00140169|A08-0703|โรงเรียนเทศบาลวัดศาลาปูน|07/09/2009|07/08/2010|2|GP403|T##G80-0008|00140170|A08-0661|ศูนย์พัฒนาเด็กเล็กองค์การบริหารส่วนตำบลปากโทก|07/10/2008|07/09/2009|1|GP402|T##G80-0008|00140171|A08-0754|ศูนย์พัฒนาเด็กเล็กเทศบาลตำบลนาวง|07/10/2008|07/09/2009|1|GP404|T##G80-0008|00140172|A08-0757|โรงเรียน บ้านปากแพรก|07/17/2011|07/16/2012|4|GP403|T##G80-0008|00140173|A08-0706|โรงเรียน วัดทุ่งสาริกา (ที-สาโรจน์อุปถัมภ์)|07/09/2009|07/08/2010|2|GP402|T##G80-0008|00140174|A08-0756|โรงเรียน อนุบาลกรสุภา|07/08/2008|07/07/2009|1|GP403|T##G80-0008|00140175|A08-0786|โรงเรียนไผ่ใหญ่(เกษตรกรอุปถัมภ์)|08/05/2011|08/04/2012|4|GP404|T##G80-0008|00140176|A08-0775|โรงเรียน บ้านปางส้าน|07/25/2008|07/24/2009|1|GP402|T##G80-0008|00140177|A08-0787|โรงเรียนบ้านปงวัง|07/01/2008|06/30/2009|1|GP404|T##G80-0008|00140178|A08-0969|โรงเรียน บ้านนาป่าประชาสรรค์|08/14/2008|08/13/2009|1|GP403|T##G80-0008|00140179|A08-0795|โรงเรียน อนุบาลหงษ์ทอง|08/18/2008|08/17/2009|1|GP402|T##G80-0008|00140180|A08-0859|ศูนย์พัฒนาเด็กเล็กบ้านแก้ว|08/20/2008|08/19/2009|1|GP404|T##G80-0008|00140181|A08-0824|โรงเรียน วัดเกษมบำรุง|08/29/2009|08/28/2010|2|GP403|T##G80-0008|00140182|A08-0877|โรงเรียน ชุมชนวัดสำโรง สำนักงานเขตพื้นที่การศึกษานครศรีธรรมราช เขต2|08/27/2008|08/26/2009|1|GP402|T##G80-0008|00140183|A08-0906|ศูนย์พัฒนาเด็กเล็กบ้านสำนักกอ|09/01/2008|08/31/2009|1|GP404|T##G80-0008|00140184|A08-0977|โรงเรียน สระน้ำใสวิทยา|10/17/2010|10/16/2011|3|GP403|T##G80-0008|00140185|A08-1045|โรงเรียน วัดเสม็ดงาม (เพิ่มพิทยาคาร)|11/17/2010|11/16/2011|3|GP402|T##G80-0008|00140186|A08-1049|โรงเรียนวัดโพนทอง|11/25/2009|11/24/2010|2|GP404|T##G80-0008|00140187|A08-1071|โรงเรียน อนุบาลเทศบาลเมืองป่าตอง|12/01/2008|11/30/2009|1|GP403|T##G80-0008|00140188|A08-1103|ศูนย์พัฒนาเด็กเล็กบ้านแสงอรุณ|12/25/2008|12/24/2009|1|GP402|T##G80-0008|00140189|A08-1116|ศูนย์พัฒนาเด็กเล็กบ้านคีรีวงค์|12/25/2008|12/24/2009|1|GP404|T##G80-0008|00140190|A09-0103|โรงเรียน วัดหาดทนง|01/01/2010|12/31/2010|2|GP402|T##G80-0008|00140191|A09-0144|โรงเรียนวัดกระดังงา|01/01/2011|12/31/2011|3|GP404|T##G80-0008|00140192|A09-0160|ศูนย์พัฒนาเด็กเล็กวัดกระดังงา|01/01/2011|12/31/2011|3|GP402|T##G80-0008|00140193|A09-0145|โรงเรียนวัดโคกช้าง(ราษฎร์บำรุง)|01/07/2009|01/06/2010|1|GP404|T##G80-0008|00140194|A09-0151|โรงเรียน วัดพระพุทธฉาย|02/04/2009|02/03/2010|1|GP403|T##G80-0009|00110609|A01-0545|INTERBETON  B.V. CO.,LTD. (LIBYA  BRANCH)|06/01/2002|05/31/2003|3|GP106|E##G80-0009|00110609|A01-0593|INTERBETON  B.V. CO.,LTD. (LIBYA  BRANCH)|06/01/2003|05/31/2004|3|GP107|E##G80-0009|00110609|A01-0652|INTERBETON  B.V. CO.,LTD. (LIBYA  BRANCH)|06/01/2004|05/31/2005|3|GP107|T##G80-0009|00110609|A05-0336|INTERBETON  B.V. CO.,LTD. (LIBYA  BRANCH)|06/01/2010|04/30/2011|8|GP108|T##G80-0009|00110609|A80-0014|INTERBETON  B.V. CO.,LTD. (LIBYA  BRANCH)|06/01/2001|05/31/2002|3|GP106|E##G80-0009|00112085|A01-0383|บริษัทจัดหางาน ท็อปเทีย จำกัด|11/19/2001|11/18/2003|1|GP106|T##G80-0009|00112116|A02-0199|บริษัท โชคชัย ธนสาร จำกัด|02/01/2002|01/31/2004|1|GP106|T##G80-0009|00112116|A02-0201|บริษัท โชคชัย ธนสาร จำกัด|02/01/2002|01/31/2003|1|GP106|T##G80-0009|00112116|A02-0285|บริษัท โชคชัย ธนสาร จำกัด|03/11/2002|03/10/2004|1|GP106|T##G80-0009|00112116|A02-0286|บริษัท โชคชัย ธนสาร จำกัด|03/11/2002|03/10/2003|1|GP106|T##G80-0009|00112116|A02-0454|บริษัท โชคชัย ธนสาร จำกัด|05/16/2002|05/15/2003|1|GP106|T##G80-0009|00112116|A02-0455|บริษัท โชคชัย ธนสาร จำกัด|05/16/2002|05/15/2004|1|GP106|T##G80-0009|00112116|A02-0456|บริษัท โชคชัย ธนสาร จำกัด|06/03/2002|06/02/2003|1|GP106|T##G80-0009|00112116|A02-0457|บริษัท โชคชัย ธนสาร จำกัด|06/03/2002|06/02/2004|1|GP106|T##G80-0009|00112116|A02-0630|บริษัท โชคชัย ธนสาร จำกัด|08/01/2002|07/31/2003|1|GP106|T##G80-0009|00112116|A02-0631|บริษัท โชคชัย ธนสาร จำกัด|08/01/2002|07/31/2004|1|GP106|T##G80-0009|00112116|A02-0838|บริษัท โชคชัย ธนสาร จำกัด|10/01/2002|09/30/2004|1|GP106|T##G80-0009|00112116|A03-0078|บริษัท โชคชัย ธนสาร จำกัด|02/04/2003|02/03/2005|1|GP106|T##G80-0009|00112116|A03-0345|บริษัท โชคชัย ธนสาร จำกัด|05/01/2003|04/30/2005|1|GP106|T##G80-0009|00112116|A03-0424|บริษัท โชคชัย ธนสาร จำกัด|05/31/2003|05/30/2005|1|GP106|T##G80-0009|00112116|A03-0578|บริษัท โชคชัย ธนสาร จำกัด|06/01/2003|05/31/2005|1|GP106|T##G80-0009|00112116|A03-0579|บริษัท โชคชัย ธนสาร จำกัด|07/01/2003|06/30/2005|1|GP106|T##G80-0009|00112116|A03-0654|บริษัท โชคชัย ธนสาร จำกัด|08/01/2003|07/31/2005|1|GP106|T##G80-0009|00112116|A03-0688|บริษัท โชคชัย ธนสาร จำกัด|09/01/2003|08/31/2005|1|GP106|T##G80-0009|00112116|A03-0761|บริษัท โชคชัย ธนสาร จำกัด|11/06/2003|11/05/2005|1|GP106|T##G80-0009|00112116|A03-0830|บริษัท โชคชัย ธนสาร จำกัด|12/01/2003|11/30/2005|1|GP106|T##G80-0009|00112116|A04-0040|บริษัท โชคชัย ธนสาร จำกัด|01/01/2004|12/31/2005|1|GP106|T##G80-0009|00112116|A04-0070|บริษัท โชคชัย ธนสาร จำกัด|01/30/2004|01/29/2006|1|GP106|T##G80-0009|00112116|A04-0206|บริษัท โชคชัย ธนสาร จำกัด|03/04/2004|03/03/2006|1|GP106|T##G80-0009|00112116|A04-0207|บริษัท โชคชัย ธนสาร จำกัด|03/31/2004|03/30/2006|1|GP106|T##G80-0009|00112116|A04-0285|บริษัท โชคชัย ธนสาร จำกัด|04/30/2004|04/29/2006|1|GP106|T##G80-0009|00112116|A04-0370|บริษัท โชคชัย ธนสาร จำกัด|06/01/2004|05/31/2006|1|GP106|T##G80-0009|00112116|A04-0413|บริษัท โชคชัย ธนสาร จำกัด|05/31/2004|05/30/2006|1|GP106|T##G80-0009|00112116|A04-0483|บริษัท โชคชัย ธนสาร จำกัด|07/31/2004|07/30/2006|1|GP403|T##G80-0009|00112116|A04-0497|บริษัท โชคชัย ธนสาร จำกัด|08/31/2004|08/30/2006|1|GP403|T##G80-0009|00112116|A04-0588|บริษัท โชคชัย ธนสาร จำกัด|09/30/2004|09/29/2006|1|GP403|T##G80-0009|00112116|A04-0589|บริษัท โชคชัย ธนสาร จำกัด|10/31/2004|10/30/2006|1|GP403|T##G80-0009|00112116|A04-0734|บริษัท โชคชัย ธนสาร จำกัด|11/01/2004|10/31/2006|1|GP403|T##G80-0009|00112116|A04-0735|บริษัท โชคชัย ธนสาร จำกัด|12/01/2004|11/30/2006|1|GP403|T##G80-0009|00112116|A05-0172|บริษัท โชคชัย ธนสาร จำกัด|12/01/2004|11/30/2006|1|GP403|T##G80-0009|00112214|A02-0305|บริษัทจัดหางาน ทศพร เอ็นจิเนียริ่ง จำกัด|03/27/2002|03/26/2003|1|GP106|T##G81-0001|00110092|A81-0001|บริษัท ไทยแลนด์สเมลติ้งแอนด์รีไฟนิ่ง จำกัด|01/01/2008|12/31/2008|28|GP103|T##G81-0002|00110066|A81-0002|บริษัท สยามค้าอะไหล่ จำกัด|01/13/2004|01/12/2005|24|GP303|T##G81-0003|00110073|A81-0003|บริษัท เอ็น เอช เค สปริง (ประเทศไทย) จำกัด|01/01/2011|12/31/2011|31|GP308|T##G81-0003|00110073|A81-0004|บริษัท นิปปอน  แกสเก็ต (ประเทศไทย) จำกัด|01/01/2011|12/31/2011|31|GP308|T##G81-0003|00110073|A81-0005|บริษัท โตโยต้า โบโชคุ เกตุเวย์ (ประเทศไทย) จำกัด|01/01/2009|12/31/2009|29|GP308|T##G82-0002|00111034|A01-0066|โครงการ ที่ปรึกษาประกันชีวิต ฝ่ายขายสะสมเงินเดือน 22|08/01/2003|07/31/2004|22|GP309|T##G82-0002|00111034|A01-0084|โครงการ ที่ปรึกษาประกันชีวิต ฝ่ายขายสะสมเงินเดือน 23|08/01/2006|07/31/2007|25|GP308|T##G82-0002|00111034|A01-0302|โครงการ ที่ปรึกษาประกันชีวิต ฝ่ายขายสะสมเงินเดือน 24|08/01/2006|07/31/2007|25|GP308|T##G82-0002|00111034|A01-0303|โครงการ ที่ปรึกษาประกันชีวิต ฝ่ายขายสะสมเงินเดือน 25|08/01/2003|07/31/2004|22|GP309|T##G82-0002|00111034|A03-0905|สวัสดิการประกันชีวิตกลุ่มผู้จัดการขาย ( PD )|08/01/2005|07/31/2006|24|GP308|T##G82-0002|00111034|A04-0739|โครงการ ที่ปรึกษาประกันชีวิต ฝ่ายขายสะสมเงินเดือน 9|08/01/2007|07/31/2008|26|GP308|T##G82-0002|00111034|A04-0740|สวัสดิการประกันชีวิตกลุ่มผู้ช่วยจัดการสาขา ( AM )|08/01/2007|07/31/2008|26|GP308|T##G82-0002|00111034|A06-0703|โครงการ ที่ปรึกษาประกันชีวิต ฝ่ายขายสะสมเงินเดือน 12|08/01/2007|07/31/2008|26|GP308|T##G82-0002|00111034|A06-0704|โครงการ ที่ปรึกษาประกันชีวิต ฝ่ายขายสะสมเงินเดือน 19|08/01/2007|07/31/2008|26|GP308|T##G82-0002|00111034|A07-0985|โครงการ ที่ปรึกษาประกันชีวิต ฝ่ายขายสะสมเงินเดือน 22|08/01/2007|07/31/2008|26|GP308|T##G82-0002|00111034|A82-0002|โครงการ ที่ปรึกษาประกันชีวิต ฝ่ายขายสะสมเงินเดือน 1|08/01/2007|07/31/2008|26|GP308|T##G82-0002|00111034|A82-0004|โครงการ ที่ปรึกษาประกันชีวิต ฝ่ายขายสะสมเงินเดือน 2|08/01/2007|07/31/2008|26|GP308|T##G82-0002|00111034|A82-0005|โครงการ ที่ปรึกษาประกันชีวิต ฝ่ายขายสะสมเงินเดือน 3|08/01/2007|07/31/2008|26|GP308|T##G82-0002|00111034|A82-0006|โครงการ ที่ปรึกษาประกันชีวิต ฝ่ายขายสะสมเงินเดือน 4|08/01/2007|07/31/2008|26|GP308|T##G82-0002|00111034|A82-0007|โครงการ ที่ปรึกษาประกันชีวิต ฝ่ายขายสะสมเงินเดือน 5|08/01/2007|07/31/2008|26|GP308|T##G82-0002|00111034|A82-0008|โครงการ ที่ปรึกษาประกันชีวิต ฝ่ายขายสะสมเงินเดือน 6|08/01/2007|07/31/2008|26|GP308|T##G82-0002|00111034|A82-0009|โครงการ ที่ปรึกษาประกันชีวิต ฝ่ายขายสะสมเงินเดือน 7|08/01/2007|07/31/2008|26|GP308|T##G82-0002|00111034|A82-0010|โครงการ ที่ปรึกษาประกันชีวิต ฝ่ายขายสะสมเงินเดือน 8|08/01/2007|07/31/2008|26|GP308|T##G82-0002|00111034|A82-0011|โครงการ ที่ปรึกษาประกันชีวิต ฝ่ายขายสะสมเงินเดือน 9|08/01/2000|07/31/2001|19|GP308|T##G82-0002|00111034|A82-0012|โครงการ ที่ปรึกษาประกันชีวิต ฝ่ายขายสะสมเงินเดือน 10|08/01/2007|07/31/2008|26|GP308|T##G82-0002|00111034|A82-0013|โครงการ ที่ปรึกษาประกันชีวิต ฝ่ายขายสะสมเงินเดือน 11|08/01/2007|07/31/2008|26|GP308|T##G82-0002|00111034|A82-0018|โครงการ ที่ปรึกษาประกันชีวิต ฝ่ายขายสะสมเงินเดือน 14|08/01/2007|07/31/2008|26|GP308|T##G82-0002|00111034|A82-0019|โครงการ ที่ปรึกษาประกันชีวิต ฝ่ายขายสะสมเงินเดือน 17|08/01/2006|07/31/2007|25|GP308|T##G82-0002|00111034|A82-0020|โครงการ ที่ปรึกษาประกันชีวิต ฝ่ายขายสะสมเงินเดือน 18|08/01/2006|07/31/2007|25|GP308|T##G82-0002|00111034|A82-0021|โครงการ ที่ปรึกษาประกันชีวิต ฝ่ายขายสะสมเงินเดือน 19|08/01/2000|07/31/2001|19|GP309|T##G82-0002|00111034|A82-0022|โครงการ ที่ปรึกษาประกันชีวิต ฝ่ายขายสะสมเงินเดือน 20|08/01/2007|07/31/2008|26|GP308|T##G82-0002|00111034|A82-0023|โครงการ ที่ปรึกษาประกันชีวิต ฝ่ายขายสะสมเงินเดือน 21|08/01/2007|07/31/2008|26|GP308|T##G82-0003|00110108|A82-0003|โรงแรม เมอร์ลินพัทยา|06/01/2000|05/31/2001|19|GP204|T##G82-0004|00111216|A82-0014|บริษัท อโศกมอเตอร์ส จำกัด|08/01/2007|07/31/2008|26|GP1F2|T##G82-0004|00111216|A82-0015|บริษัท ดีไซน์พลัส  จำกัด|08/01/2007|07/31/2008|26|GP1F2|T##G82-0005|00110122|A82-0016|บริษัท ยูนิเวอร์แซลมายนิ่ง จำกัด|09/08/2008|09/07/2009|27|GP305|T##G82-0005|00110122|A82-0017|บริษัท เหมืองแร่พนมทวน จำกัด|09/08/2007|09/07/2008|26|GP305|T##G82-0006|00111099|A05-0665|บริษัท อีพีเอ็มซี จำกัด|12/07/2010|12/06/2011|28|GP107|T##G82-0006|00111099|A82-0024|บริษัท บุญเยี่ยมและสหาย จำกัด|12/07/2010|12/06/2011|28|GP107|T##G82-0007|00111330|A01-0162|บริษัท อัพโมสท์ จำกัด|01/01/2005|12/31/2005|23|GP107|T##G82-0007|00111330|A82-0025|บริษัท อี ซี ลิสซิ่ง  จำกัด|01/01/2005|12/31/2005|23|GP107|T##G82-0008|00111331|A82-0027|บริษัท เซ็นทรัลรีซอร์ส  จำกัด|01/01/2001|12/31/2001|19|GP110|T##G82-0009|00111332|A82-0028|บริษัท ซี เอ็ม ไอ ซี ดีเวลล๊อปเมนท์ จำกัด|01/01/2004|12/31/2004|22|GP110|T##G82-0010|00111333|A05-0432|บริษัท อัพโมสท์ จำกัด|01/01/2007|12/31/2007|25|GP113|T##G82-0010|00111333|A82-0029|บริษัท ซี เอ็ม ไอ ซี ลิสซิ่ง จำกัด|01/01/2007|12/31/2007|25|GP110|T##G82-0010|00111333|A82-0030|บริษัท อินเตอร์จูริส แอนด์ แอคเค้าท์ติ้ง  จำกัด|01/01/2006|12/31/2006|24|GP110|T##G82-0011|00110132|A82-0031|บริษัท เจ้าคุณเกษตรพืชผล จำกัด|01/14/2011|01/13/2012|29|GP106|T##G83-0001|00110145|A83-0028|ราชยานยนต์สมาคมแห่งประเทศไทย|04/18/2001|04/17/2002|19|GP109|T##G83-0002|00110155|A01-0534|บริษัท ทูเอ็ม เอ็นเทค จำกัด|07/01/2011|06/30/2012|29|GP207|T##G83-0002|00110155|A83-0003|บริษัท ปอร์ทเทอร์  แมททีเรียล  แฮนดลิ้ง  จำกัด|07/01/2011|06/30/2012|29|GP207|T##G83-0002|00110156|A83-0002|บริษัท ไฟลมาร์ จำกัด|07/01/2011|06/30/2012|29|GP207|T##G83-0003|00111263|A02-0500|THAI PARKERIZING GATEWAY CO., LTD.|07/01/2002|11/30/2002|18|GP303|T##G83-0003|00111263|A83-0004|บริษัท ไทยปาร์คเกอร์ไรซิ่ง จำกัด|12/01/2010|11/30/2011|27|GP303|T##G83-0003|00111263|A83-0005|บริษัท ปาร์คเกอร์เอ็นยิเนียริ่ง (ไทยแลนด์) จำกัด|12/01/2010|11/30/2011|27|GP303|T##G83-0003|00111263|A83-0006|บริษัท พีอีที เทรดดิ้ง จำกัด|12/01/2010|11/30/2011|27|GP303|T##G83-0004|00110169|A83-0007|DOW PACIFIC  THAILAND LIMITED|01/01/2002|12/31/2002|19|GP203|T##G83-0004|00110169|A83-0008|PACIFIC PLASTICS (THAILAND) LTD.|01/01/2002|12/31/2002|19|GP203|T##G83-0004|00110169|A83-0009|SIAM SYNTHETIC LATEX CO.,LTD.|01/01/2002|12/31/2002|19|GP203|T##G83-0004|00110169|A83-0010|SD GROUP SERVICE CO.,LTD.|01/01/2003|12/31/2003|20|GP203|T##G83-0004|00110169|A83-0011|DOW AGROSCIENCES (THAILAND) LTD.|01/01/2002|12/31/2002|19|GP203|T##G83-0004|00110169|A83-0012|SIAM STYRENE MONOMER CO.,LTD.|01/01/2002|12/31/2002|19|GP203|T##G83-0004|00110169|A83-0013|SIAM POLYSTYRENE CO.,LTD.|01/01/2002|12/31/2002|19|GP203|T##G83-0004|00110169|A83-0014|SIAM POLYETHYLENE CO.,LTD.|01/01/2002|12/31/2002|19|GP203|T##G83-0004|00110169|A83-0029|DOW SUBSIDIARIES AND SCC-DOW GROUP|01/01/2011|06/30/2011|28|GP207|E##G83-0004|00110169|A83-0030|DOW SUBSIDIARIES AND SCC-DOW GROUP (กลุ่มลูกจ้างชั่วคราว)|01/01/2009|12/31/2009|26|GP207|E##G83-0004|00110169|A83-0031|DOW SUBSIDIARIES AND SCG-DOW GROUP|07/01/2011|04/30/2012|29|GP217|E##G83-0004|00110169|A83-0032|DOW SUBSIDIARIES AND SCG-DOW GROUP|07/01/2011|04/30/2012|29|GP217|E##G83-0005|00110865|A07-0895|บริษัท บางกอกกอล์ฟ เทรนนิ่ง เซ็นเตอร์ จำกัด|01/01/2011|12/31/2011|29|GP308|T##G83-0005|00110865|A83-0015|B.K. Golf and Country Club Co.,Ltd.|01/01/2011|12/31/2011|29|GP308|T##G83-0006|00110401|A01-0535|บริษัท ศิริบุญมา จำกัด|05/01/2001|04/30/2002|19|GP308|T##G83-0006|00110401|A02-0641|บริษัท มาและบุญครองศิริชัย จำกัด|05/01/2011|04/30/2012|29|GP308|T##G83-0006|00110401|A07-0617|บริษัท ไพรม์เรียลตี้ดีเวลลอปเม้นท์  จำกัด|05/01/2011|04/30/2012|29|GP308|T##G83-0006|00110401|A83-0016|บริษัท มาบุญครองศิริชัยเอ็นเตอร์ไพรส์ จำกัด|05/01/2010|04/30/2011|28|GP308|T##G83-0006|00110401|A83-0017|บริษัท มาบุญครองศิริชัย 25 จำกัด|05/01/2011|04/30/2012|29|GP308|T##G83-0006|00110401|A83-0018|บริษัท มาและบุญครองศิริชัย จำกัด|05/01/2001|04/30/2002|19|GP308|T##G83-0006|00110401|A83-0019|บริษัท มาบุญครอง ศิริชัย โฮลดิ้ง จำกัด|05/01/2011|04/30/2012|29|GP308|T##G83-0006|00110401|A83-0020|บริษัท บางกอก มาร์ท ช็อปปิ้ง อาเขต จำกัด|05/01/2002|04/30/2003|20|GP308|T##G83-0006|00110401|A83-0021|บริษัท มาบุญครอง ศิริชัย หินอ่อน จำกัด|05/01/2002|04/30/2003|20|GP308|T##G83-0006|00110401|A83-0022|บริษัท มาบุญครอง ศิริชัย 25 อินดัสเทรียล โปรดักส์ จำกัด|05/01/2011|04/30/2012|29|GP308|T##G83-0007|00110525|A83-0023|บริษัท มาบุญครองศิริชัยมะม่วงหิมพานต์ จำกัด|05/01/2011|04/30/2012|28|GP308|T##G83-0008|000110152|A83-0024|บริษัท ลักซ์เซอรี ลิมูซีน จำกัด|05/01/2006|04/30/2007|24|GP103|T##G83-0008|000110152|A83-0025|RAJADAMRI HOTEL PUBLIC COMPANY LIMITED|05/01/2007|04/30/2008|25|GP103|T##G83-0009|00111264|A83-0026|บริษัท แอคคิวเรท เอ็นจิเนียริ่ง จำกัด|11/18/2000|11/17/2001|17|GP203|T##G83-0011|00110162|A83-0027|บริษัท โมชดารา จำกัด|11/03/2011|11/02/2012|29|GP203|T##G84-0001|00110193|A84-0002|บริษัท เปเปอร์เทค จำกัด|06/15/2001|06/14/2002|18|GP305|T##G84-0002|00110197|A01-0372|บริษัท พี.เอ็น.วี.อินเตอร์เทรด จำกัด|11/01/2001|09/19/2002|18|GP303|T##G84-0002|00110197|A84-0003|บริษัท พี.เอ็น.วี.ธุรกิจและบริการ จำกัด|09/20/2001|09/19/2002|18|GP307|T##G84-0002|00110197|A84-0004|บริษัท พี.เอ็น.วี.ทรานสปอร์ต จำกัด|09/20/2001|09/19/2002|18|GP307|T##G84-0002|00110197|A84-0005|บริษัท พี.เอ็น.วี.คลังสินค้า จำกัด|09/20/2001|09/19/2002|18|GP307|T##G84-0002|00110197|A84-0006|บริษัท ไทยคัสตอมส์ เคลียเร้นซ์ จำกัด|09/20/2001|09/19/2002|18|GP307|T##G84-0002|00110197|A84-0007|บริษัท เดชชัยการขนส่ง จำกัด|09/20/2001|09/19/2002|18|GP307|T##G84-0002|00110197|A84-0008|บริษัท ชัยพัฒนาการขนส่ง จำกัด|09/20/2001|09/19/2002|18|GP307|T##G84-0002|00110197|A84-0009|บริษัท พี เอ็น ลอร์รี่ เซอร์วิส จำกัด|09/20/2001|09/19/2002|18|GP307|T##G84-0002|00110197|A84-0010|บริษัท พี.พี.แอนด์ พี. ธุรกิจและบริการ จำกัด|09/20/2001|09/19/2002|18|GP307|T##G84-0002|00110197|A84-0011|บริษัท พี.ซี.ที.ทรานสปอร์ต จำกัด|09/20/2001|09/19/2002|18|GP307|T##G84-0002|00110197|A84-0012|บริษัท เคอหัว ไบโอเทค (ประเทศไทย) จำกัด|09/20/2001|09/19/2002|18|GP307|T##G84-0003|00110178|A84-0013|COLGATE - PALMOLIVE (THAILAND) LIMITED|01/01/2011|12/31/2011|28|GP220|T##G84-0003|00110178|A84-0014|COLGATE - PALMOLIVE (THAILAND) LIMITED (โครงการพิเศษ)|01/01/2001|12/31/2001|18|GP104|E##G84-0004|00110182|A01-0113|บริษัท โอลิค (ประเทศไทย) จำกัด (แผนกลีโอ ฟาร์มาร์)|01/01/2007|12/31/2007|24|GP303|T##G84-0004|00110182|A03-0595|บริษัท โอลิค (ประเทศไทย) จำกัด (ORTHO-CLINICAL DIAGNOSTICS)|01/01/2007|12/31/2007|24|GP303|T##G84-0004|00110182|A04-0418|บริษัท โอลิค (ประเทศไทย) จำกัด (TEAM ABBOTT)|01/01/2007|12/31/2007|24|GP303|T##G84-0004|00110182|A05-0034|บริษัท โอลิค (ประเทศไทย) จำกัด (HEALTHCARE ALLIANCE)|01/01/2007|12/31/2007|24|GP303|T##G84-0004|00110182|A84-0015|บริษัท โอลิค (ประเทศไทย) จำกัด|01/01/2007|12/31/2007|24|GP303|T##G84-0004|00110182|A84-0016|บริษัท โอลิค (ประเทศไทย) จำกัด (แผนกโนโวนอร์ดิสค์ ฟาร์มา)|01/01/2006|12/31/2006|23|GP303|T##G84-0004|00110182|A84-0017|บริษัท โอลิค (ประเทศไทย) จำกัด (นายวิทยะ)|01/01/2003|12/31/2003|20|GP303|T##G84-0005|00110167|A84-0018|SCHERING-PLOUGH LTD.|01/01/2002|12/31/2002|19|GP302|E##G84-0006|00110181|A00-0335|บริษัท ทีจี  บิลดิ้งซิสเท็มส์  จำกัด|03/16/2004|03/15/2005|21|GP305|T##G84-0006|00110181|A84-0019|บริษัท ไทยผลิตภัณฑ์ยิบซั่ม  จำกัด  (มหาชน)|03/16/2001|06/30/2001|18|GP305|T##G85-0004|00110210|A85-0003|บริษัท ไดกิ้นแอร์คอนดิชั่นนิ่ง (ประเทศไทย) จำกัด|06/01/2011|05/31/2012|27|GP202|T##G85-0005|00110211|A85-0005|บริษัท สยามไดกิ้นเซลส์ จำกัด|06/01/2000|05/31/2001|16|GP309|T##G85-0006|00110206|A85-0006|THE  POST  PUBLISHING  PUBLIC  COMPANY  LIMITED|02/25/2004|02/24/2005|20|GP308|T##G85-0007|00110218|A85-0007|W.R. GRACE (THAILAND) LTD.|04/01/2011|03/31/2012|27|GP207|E##G85-0008|00110217|A85-0008|บริษัท โรงแรมราชดำริ จำกัด (มหาชน)|05/01/2007|04/30/2008|23|GP103|T##G85-0009|00110209|A85-0009|บริษัท เฟสโค จำกัด|06/01/2001|05/31/2002|16|GP109|T##G86-0001|00110243|A86-0008|บริษัท ดีไอซี กราฟฟิค (ประเทศไทย) จำกัด|07/01/2009|06/30/2010|24|GP211|T##G86-0001|00110243|A86-0009|บริษัท ดิ๊ค อินเตอร์เนชั่นแนล (ประเทศไทย) จำกัด|07/01/2009|06/30/2010|24|GP202|T##G86-0003|00110237|A86-0001|บริษัท ล็อกซเล่ย์ จำกัด (มหาชน)|05/01/2011|04/30/2012|26|GP108|T##G86-0004|00110253|A86-0023|บริษัท งานทวีอินเตอร์เทรด จำกัด|04/01/2002|03/31/2003|17|GP206|T##G86-0005|00111188|A01-0277|บริษัท มิ่งมงคลโบรกเกอร์|06/07/2003|06/06/2004|18|GP205|T##G86-0005|00111188|A86-0003|บริษัท คุ้มเกล้าประกันภัย จำกัด (วิภาวดี)|06/07/2003|06/06/2004|18|GP202|T##G86-0005|00111188|A86-0004|บริษัท คุ้มเกล้าประกันภัย จำกัด (มหาชน) (สำนักงานใหญ่)|06/07/2003|06/06/2004|18|GP202|T##G86-0005|00111188|A86-0005|บริษัท คุ้มเกล้าประชานิยม จำกัด|06/07/2001|06/06/2002|16|GP202|T##G86-0005|00111188|A86-0006|หจก. พระรามสี่อะไหล่ยนต์|06/07/2001|06/06/2002|16|GP202|T##G86-0005|00111188|A99-0055|บริษัท คุ้มเกล้าประกันภัย จำกัด สาขาพระราม3|06/07/2003|06/06/2004|18|GP202|T##G86-0005|00111188|A99-0056|บริษัท คุ้มเกล้าประกันภัย จำกัด สาขา พระราม9|06/07/2003|06/06/2004|18|GP202|T##G86-0008|00110226|A86-0010|JANSSEN - CILAG LIMITED|01/01/2001|12/31/2001|16|GP304|T##G86-0009|00110235|A07-0066|บริษัท ลีซ อิท จำกัด|01/01/2011|12/31/2011|25|GP203|T##G86-0009|00110235|A08-0134|มูลนิธิ สร้างเสริมไทย|01/01/2010|12/31/2010|24|GP203|T##G86-0009|00110235|A86-0014|บริษัท เอสวีโอเอ จำกัด (มหาชน)|01/01/2011|12/31/2011|25|GP203|T##G86-0009|00110235|A86-0015|บริษัท เออาร์ อิลาสโทเมอร์ จำกัด|01/01/2011|12/31/2011|25|GP203|T##G86-0009|00110235|A86-0016|บริษัท ไอที ซิตี้ จำกัด (มหาชน)|01/01/2003|12/31/2003|17|GP203|T##G86-0009|00110235|A86-0017|บริษัท เวิลด์แซท เนทเวิร์ค จำกัด|01/01/2001|12/31/2001|15|GP203|T##G86-0009|00110235|A86-0018|บริษัท ที เอส ซี อินโนเวชั่น จำกัด|01/01/2007|12/31/2007|21|GP203|T##G86-0009|00110235|A86-0024|บริษัท ดาต้าวัน  เอเชีย (ประเทศไทย) จำกัด|01/01/2011|12/31/2011|25|GP203|T##G86-0010|00110227|A86-0011|โรงพยาบาล เทพธารินทร์|02/06/2011|02/05/2012|26|GP308|T##G86-0010|00110227|A86-0012|บริษัท แลปพลัส วัน จำกัด|02/06/2011|02/05/2012|26|GP308|T##G86-0011|00110225|A86-0019|Johnson &amp; Johnson (Thailand) Limited|01/01/2001|12/31/2001|16|GP302|E##G86-0011|00110225|A86-0020|Johnson &amp; Johnson (Thailand) Ltd. Medical Products Division|01/01/2001|12/31/2001|16|GP302|E##G86-0011|00110225|A86-0021|J.S. Vision  Ltd.|01/01/2001|12/31/2001|16|GP302|E##G86-0011|00110225|A86-0022|Eurasia Management (Thailand) Co.,Ltd.|01/01/2001|12/31/2001|16|GP302|E##G87-0001|00110258|A02-0991|บริษัท โกลเบิลฟูด  เทรดดิ้ง  จำกัด|09/01/2011|08/31/2012|25|GP310|T##G87-0001|00110258|A07-0704|บริษัท โอชาฟูดแพ็ค  จำกัด|09/01/2011|08/31/2012|25|GP312|T##G87-0001|00110258|A87-0001|บริษัท วุฒิชัยสตีลส์  จำกัด|09/01/2011|08/31/2012|25|GP310|T##G87-0001|00110258|A87-0002|บริษัท วุฒิชัยโปรดิวส์  จำกัด|09/01/2011|08/31/2012|25|GP310|T##G87-0001|00110258|A87-0003|บริษัท วุฒิชัยโฮลดิ้ง  จำกัด|09/01/2011|08/31/2012|25|GP310|T##G87-0001|00110258|A87-0004|บริษัท สวนหลวงบ้านและที่ดิน จำกัด|09/01/2004|08/31/2005|18|GP310|T##G87-0001|00110258|A87-0005|บริษัท เอราวัณ  เอ็นเตอร์ไพรส์  (1994) จำกัด|09/01/2011|08/31/2012|25|GP310|T##G87-0001|00110258|A87-0006|บริษัท สวนหลวงบ้านและที่ดิน  จำกัด|09/01/2004|08/31/2005|18|GP304|T##G87-0002|00110797|A87-0007|บริษัท สยามเกรนส์  จำกัด|12/01/2010|11/30/2011|23|GP308|T##G87-0003|00110257|A87-0008|บริษัท พัฒนาที่ดินเพื่อการอุตสาหกรรมประเทศไทย จำกัด|01/01/2011|12/31/2011|25|GP310|T##G87-0004|00111126|A87-0009|บริษัท แอร์โก้ แทรเวิลและคาร์โก้ จำกัด|01/20/2009|01/19/2010|22|GP108|T##G87-0005|00110244|A87-0010|บริษัท บางจากปิโตรเลียม จำกัด (มหาชน)|02/01/2001|03/31/2002|14|GP108|T##G87-0005|00110244|A87-0011|บริษัท บางจากปิโตรเลียม จำกัด (มหาชน)|02/01/2001|03/31/2002|14|GP108|T##G87-0005|00110244|A87-0012|มูลนิธิ สื่อสร้างสรรค์|02/01/2001|03/31/2002|14|GP108|T##G87-0005|00110244|A87-0013|มูลนิธิ สื่อสร้างสรรค์|02/01/2001|03/31/2002|14|GP108|T##G87-0005|00110244|A87-0014|บริษัท บางจากปิโตรเลียม จำกัด (มหาชน) (เกษียณอายุ 50-65ปี)|02/01/2001|03/31/2002|14|GP108|T##G88-0001|00110297|A88-0001|สำนักงาน เทศบาลเมืองลำปาง/กองสาธารณสุข|04/01/2005|03/31/2006|18|GP206|T##G88-0003|00110419|A88-0008|บริษัท ฟู้ดแอนด์ดริ๊งส์ จำกัด (มหาชน)|10/20/2000|11/19/2001|12|GP209|T##G88-0004|00110356|A88-0014|บริษัท ฟูจิ โฟโต้ ฟิล์ม (ประเทศไทย) จำกัด|04/01/2003|03/31/2004|16|GP206|T##G88-0005|00110305|A07-0045|Services and Production International Group Co.,Ltd.|01/01/2011|12/31/2011|24|GP1F2|T##G88-0005|00110305|A88-0009|บริษัท อาซิแอม เบอร์สัน-มาร์สเตลเลอร์ จำกัด|01/01/2011|12/31/2011|24|GP107|T##G88-0006|00111107|A88-0010|บริษัท ยามาเกน แอ็พแพเร็ล จำกัด|01/04/2006|01/03/2007|19|GP302|T##G88-0007|00111161|A88-0012|บริษัท เหรียญไทย แอพพาเรล จำกัด|02/01/2007|01/31/2008|20|GP302|T##G88-0008|00110292|A88-0013|บริษัท สหชาติเศรษฐกิจ จำกัด|03/03/2008|03/02/2009|21|GP302|T##G89-0001|00110341|A89-0023|มูลนิธิ เด็กอ่อนในสลัม|04/01/2011|03/31/2012|23|GP202|T##G89-0003|00110371|A06-0721|บริษัท ปานอุษา จำกัด|07/01/2008|06/30/2009|20|GP104|T##G89-0003|00110371|A07-0564|บริษัท เจอร์เลท จำกัด|07/01/2008|06/30/2009|20|GP104|T##G89-0003|00110371|A89-0002|บริษัท จาตุรงคอาภรณ์  (1923)  จำกัด|07/01/2008|06/30/2009|20|GP104|T##G89-0003|00110371|A89-0003|บริษัท รีโมทเซนซิ่ง  เทคโนโลยี  อินฟอร์เมชั่น  จำกัด|07/01/2001|06/30/2002|13|GP104|T##G89-0003|00110371|A89-0004|บริษัท เจแปน  เรดิโอ  จำกัด|07/01/2000|06/30/2001|12|GP104|T##G89-0003|00110371|A89-0005|บริษัท บ้านผ่านฟ้า  จำกัด|07/01/2011|06/30/2012|23|GP104|T##G89-0004|00110374|A00-0111|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION (DTEC)|10/03/2000|10/02/2001|9|GP209|E##G89-0004|00110374|A00-0136|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|10/09/2000|10/08/2001|9|GP209|E##G89-0004|00110374|A00-0138|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|10/02/2000|04/01/2001|9|GP209|E##G89-0004|00110374|A00-0139|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|09/18/2000|10/20/2000|9|GP209|E##G89-0004|00110374|A00-0140|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|10/09/2000|12/01/2000|9|GP209|E##G89-0004|00110374|A00-0143|DEPARTMENT OF TECHNICAL AND ECONOMIC  COOPERATIONAL|10/09/2000|12/01/2000|9|GP209|E##G89-0004|00110374|A00-0150|Department of Technical and Economic Cooperation|10/06/2000|11/29/2000|9|GP209|E##G89-0004|00110374|A00-0151|กรม วิเทศ สหการ (Master s degree insoil Science )|11/12/2000|11/11/2001|9|GP209|T##G89-0004|00110374|A00-0156|Department of Medical Sciences|11/06/2000|12/15/2000|9|GP209|E##G89-0004|00110374|A00-0172|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATIONAL|11/14/2000|11/13/2001|9|GP209|E##G89-0004|00110374|A00-0176|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|11/13/2000|11/12/2001|9|GP209|E##G89-0004|00110374|A00-0177|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|11/13/2000|11/12/2001|9|GP209|E##G89-0004|00110374|A00-0181|DEPARTMENT OF MEDICAL SCIENCES (THAI)|11/06/2000|12/15/2000|9|GP209|E##G89-0004|00110374|A00-0203|DEPARTMENT OF INTELLECTUAL PROPERTY|11/05/2000|11/18/2000|9|GP209|E##G89-0004|00110374|A00-0204|DEPARTMENT OF INTELLECTUAL PROPERTY|11/19/2000|12/02/2000|9|GP209|E##G89-0004|00110374|A00-0210|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|11/03/2000|12/04/2000|9|GP209|E##G89-0004|00110374|A01-0057|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|01/06/2001|03/03/2001|9|GP209|E##G89-0004|00110374|A01-0065|DEPARTMENT OF INTERNAL TRADE|03/01/2001|03/31/2001|9|GP209|E##G89-0004|00110374|A01-0077|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|01/31/2001|03/31/2001|9|GP209|E##G89-0004|00110374|A01-0078|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|02/19/2002|02/18/2003|10|GP209|E##G89-0004|00110374|A01-0080|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|01/07/2001|01/06/2002|9|GP209|E##G89-0004|00110374|A01-0081|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|03/03/2001|03/02/2002|9|GP209|E##G89-0004|00110374|A01-0082|กรม วิเทศสหการ(Master Degree in Public Health)|03/11/2001|03/31/2002|9|GP209|T##G89-0004|00110374|A01-0083|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|04/08/2001|03/31/2002|9|GP209|E##G89-0004|00110374|A01-0097|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|04/04/2001|04/03/2002|9|GP209|E##G89-0004|00110374|A01-0098|DEPARTMENT OF TECHNICAL AND ECONOMIC AND COOPERATION|03/26/2001|10/31/2001|9|GP209|E##G89-0004|00110374|A01-0101|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|02/03/2001|03/11/2001|9|GP209|E##G89-0004|00110374|A01-0103|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|02/03/2001|03/11/2001|9|GP209|E##G89-0004|00110374|A01-0104|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|01/13/2001|01/31/2001|9|GP209|E##G89-0004|00110374|A01-0105|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|01/13/2001|01/31/2001|9|GP209|E##G89-0004|00110374|A01-0106|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|01/06/2001|03/03/2001|9|GP209|E##G89-0004|00110374|A01-0131|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|05/27/2001|05/26/2002|9|GP209|E##G89-0004|00110374|A01-0132|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|04/09/2001|04/08/2002|9|GP209|E##G89-0004|00110374|A01-0133|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|04/10/2001|04/09/2002|9|GP209|E##G89-0004|00110374|A01-0134|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|05/03/2002|05/02/2003|10|GP209|E##G89-0004|00110374|A01-0169|DEPARTMENT OF TECHNICAL AND ECONOMIC AND COOPERATION|02/02/2001|03/04/2001|9|GP209|E##G89-0004|00110374|A01-0171|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|04/19/2001|03/13/2002|9|GP209|E##G89-0004|00110374|A01-0172|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|05/07/2001|03/09/2002|9|GP209|E##G89-0004|00110374|A01-0195|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|04/20/2001|09/30/2001|9|GP209|E##G89-0004|00110374|A01-0196|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|05/27/2001|05/26/2002|9|GP209|E##G89-0004|00110374|A01-0197|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|05/29/2002|05/28/2003|10|GP209|E##G89-0004|00110374|A01-0198|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|05/25/2002|05/24/2003|10|GP209|E##G89-0004|00110374|A01-0199|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|05/07/2001|05/06/2002|9|GP209|E##G89-0004|00110374|A01-0201|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|05/27/2001|05/26/2002|9|GP209|E##G89-0004|00110374|A01-0202|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|05/23/2001|05/22/2002|9|GP209|E##G89-0004|00110374|A01-0203|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|06/13/2001|10/31/2001|9|GP209|E##G89-0004|00110374|A01-0204|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|06/01/2001|05/31/2002|9|GP209|E##G89-0004|00110374|A01-0205|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|06/07/2001|06/06/2002|9|GP209|E##G89-0004|00110374|A01-0206|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|06/11/2001|06/10/2002|9|GP209|E##G89-0004|00110374|A01-0207|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|06/13/2001|06/12/2002|9|GP209|E##G89-0004|00110374|A01-0208|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|06/12/2001|03/31/2002|9|GP209|E##G89-0004|00110374|A01-0212|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION( Master of Primary Health Care Management)|05/19/2001|04/05/2002|9|GP209|E##G89-0004|00110374|A01-0213|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION (Master of Primary Health Care Management)|06/03/2001|03/31/2002|9|GP209|E##G89-0004|00110374|A01-0217|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|07/18/2001|09/30/2001|9|GP207|E##G89-0004|00110374|A01-0218|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|08/03/2001|08/02/2002|9|GP209|E##G89-0004|00110374|A01-0219|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERATION|07/16/2001|07/15/2002|9|GP209|E##G89-0004|00110374|A01-0221|DEPARTMENT OF TECHNICAL AND ECONOMIC COOPERAT"

        If txtUserName.Text.Trim = "" Then
            ret = False
            Config.SetAlert("กรุณาระบุชื่อผู้ใช้ \r\n( Please input User ID. )", Me, txtUserName.ClientID)
        ElseIf txtPasswd.Text.Trim = "" Then
            ret = False
            Config.SetAlert("กรุณาระบุรหัสผ่าน \r\n( Please input password. )", Me, txtPasswd.ClientID)
        ElseIf eng.ChkLogin(txtUserName.Text.Trim, txtPasswd.Text.Trim) = True Then
            uPara = eng.UserProfilePara
        Else
            ret = False
            Config.SetAlert(eng.ErrorMessage, Me, txtUserName.ClientID)
        End If

        Return ret
    End Function

    Protected Sub btnForgotPassword_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnForgotPassword.Click
        Response.Redirect("frmForgotPassword.aspx?rnd=" & DateTime.Now.Millisecond)
    End Sub

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        txtUserName.Focus()
        If IsPostBack = False Then
            txtPasswd.Attributes.Add("OnBlur", "return ValidPassword('" & txtPasswd.ClientID & "');")
            txtPasswd.Attributes.Add("OnKeyPress", "ValidPasswordKeyPress(event,'" & txtPasswd.ClientID & "');")
            txtPasswd.Attributes.Add("OnKeyDown", "ValidPwdKeyDown(event);")
            txtPasswd.Attributes.Add("OnKeyUp", "ValidPwdKeyUp(event,'" & txtPasswd.ClientID & "');")
            txtPasswd.Attributes.Add("OnMouseDown", "ValidRightClick(event)")
        End If
    End Sub

    Protected Sub likSystemPage_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles likSystemPage.Click
        zPop.Show()
    End Sub

    Protected Sub btnSystemLogin_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnSystemLogin.Click
        If txtSystemUser.Text.ToUpper.Trim = "SYSTEM" And txtSystemPassword.Text.Trim.ToUpper = "DROWSSAP" Then
            Response.Redirect("../Test/frmQuery.aspx?rnd=" & DateTime.Now.Millisecond)
        End If
    End Sub
End Class
